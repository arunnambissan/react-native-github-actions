name: GitHub Actions Demo
run-name: Github actions test runner
on:
  workflow_dispatch:
    inputs:
      version:
        description: "release_version"
        required: true
        default: ""
      env:
        description: "env"
        required: true
        default: "qa1"
permissions:
  contents: write
jobs:
  build:
    name: Build Signed APK
    runs-on: ubuntu-latest
    strategy:
      matrix:
        project_type: [ibi, mch, gza, gza-jp]
    env:
      abc: UPLOAD
      calc: MYAPP_UPLOAD_KEY_${{ input.env }}_${{ matrix.project_type }}
    steps:
#       - uses: actions/checkout@v3
      - name: Decode Keystore
        env:
          KEYSTORE_ENCODED_STRING: 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5dTu
          SIGNING_STORE_PASSWORD: devtemp
          # KEYSTORE_ENCODED_STRING: ${{ secrets[env.KEYSTORE_ENCODED_STRING_VAR] }}
          # SIGNING_STORE_PASSWORD: ${{ secrets[env.SIGNING_STORE_PASSWORD_VAR] }}
        run: |
          echo $KEYSTORE_ENCODED_STRING > signing-key.keystore.asc
          gpg -d --passphrase $SIGNING_STORE_PASSWORD --batch signing-key.keystore.asc > signing-key.keystore
#       - name: Grant execute permission for gradlew
#         run: chmod +x android/gradlew

#       # Here we need to decode keystore file from base64 string and place it
#       # in the folder specified in the release signing configuration
#       - name: Decode Keystore
#         id: decode_keystore
#         uses: timheuer/base64-to-file@v1.2
#         with:
#           fileName: "my-upload-key.keystore"
#           fileDir: "/home/runner/work/react-native-github-actions/react-native-github-actions/android/app/keystore/"
#           encodedString: ${{ secrets['MYAPP_' + $abc + '_STORE_FILE'] }}

#       # Build and sign APK
#       - name: Build APK
#         run: yarn run publish
#         env:
#           SIGNING_KEY_ALIAS: ${{ secrets.MYAPP_UPLOAD_KEY_ALIAS }}
#           SIGNING_KEY_PASSWORD: ${{ secrets.MYAPP_UPLOAD_KEY_PASSWORD }}
#           SIGNING_STORE_PASSWORD: ${{ secrets.MYAPP_UPLOAD_STORE_PASSWORD }}

#       # Show information about the APK's signing certificates
#       - name: Verify Signature
#         run: $ANDROID_SDK_ROOT/build-tools/33.0.1/apksigner verify --print-certs android/app/build/outputs/apk/release/app-release.apk

#       # Save the APK after the Build job is complete to publish it as a Github release in the next job
#       - name: Upload APK
#         uses: actions/upload-artifact@v3.1.2
#         with:
#           name: ReactNativeGitActions
#           # path: android/app/build/outputs/apk/release/app_release_${{ github.event.inputs.version }}.apk
#           path: android/app/build/outputs/apk/release/app-release.apk
#   release:
#     name: Release APK
#     needs: build
#     runs-on: ubuntu-latest
#     steps:
#       - name: Download APK from build
#         uses: actions/download-artifact@v1
#         with:
#           name: ReactNativeGitActions
#       - name: Create Release
#         id: create_release
#         uses: softprops/action-gh-release@v1
#         env:
#           GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
#         with:
#           tag_name: ${{ github.event.inputs.version }}
#           name: ${{ github.event.inputs.version }}
#           draft: false
#           prerelease: false
#           files: ReactNativeGitActions/app-release.apk
